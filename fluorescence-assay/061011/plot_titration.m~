% Plot data.
clf;

clear;


ligand_concentration = 20 * 2.^(-(0:11));


wavelengths = { '280-350', '280-480', '350-480', '280-350-480-FRET', '290-420', '300-480', '270-420' };
nwavelengths = length(wavelengths);

nx = 4;
ny = nwavelengths;

for i = 1:nwavelengths
  wavelength = wavelengths{i};
  filename = sprintf('quinazoline-titration-%s.txt', wavelength);
  x = textread(filename);
  
  subplot(ny,nx,nx*(i-1)+1);
  plot(x(1:2,:)', '.-');
  legend('1 uM p38', 'buffer');
  title('erlotinib');
  xlabel('ligand 1:2 dilution');
  ylabel(wavelength);
  set(gca,'XTick', 1:12);
  oldaxis = axis;
  axis([0 13 0  oldaxis(4)]);
  %set(gca, 'XTickLabel', {'20 uM', '10 uM', '5 uM', '2.5 uM', '1.25 uM', '625 nM', '313 nM', '156 nM', '78 nM', '39 nM', '20 nM', '10 nM'})
  
  subplot(ny,nx,nx*(i-1)+2);
  plot(x(3:4,:)', '.-');
  legend('1 uM p38', 'buffer');
  title('bosutinib');
  xlabel('ligand 1:2 dilution');
  ylabel(wavelength);
  set(gca,'XTick', 1:12);
  oldaxis = axis;
  axis([0 13 0  oldaxis(4)]);

  subplot(ny,nx,nx*(i-1)+3);
  plot(x(5:6,:)', '.-');
  legend('1 uM p38', 'buffer');
  title('gefitinib');
  xlabel('ligand 1:2 dilution');
  ylabel(wavelength);
  set(gca,'XTick', 1:12);
  oldaxis = axis;
  axis([0 13 0  oldaxis(4)]);
  xlabel('ligand 1:2 dilution');
  subplot(ny,nx,nx*(i-1)+4);
  plot(x(7:8,:)', '.-');
  legend('1 uM p38', 'buffer');
  title('quinazoline');

  ylabel(wavelength);
  set(gca,'XTick', 1:12);
  oldaxis = axis;
  axis([0 13 0  oldaxis(4)]);
end

filename = 'quinazoline-titration.eps';
%print('-depsc', filename);
scale = 1.5;
exportfig(gcf, filename, 'width', scale*7.5, 'height', scale*10, 'color', 'cmyk');
system(sprintf('epstopdf %s', filename));


